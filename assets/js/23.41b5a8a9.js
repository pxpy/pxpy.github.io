(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{436:function(s,a,t){"use strict";t.r(a);var r=t(3),e=Object(r.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("ArticleTopAd"),s._v(" "),a("h2",{attrs:{id:"索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引"}},[s._v("#")]),s._v(" 索引")]),s._v(" "),a("p",[s._v("空间换时间，索引的体积大约是表的1.5倍")]),s._v(" "),a("p",[s._v("一般设置在表的某些列上")]),s._v(" "),a("p",[s._v("两个列合起来索引是复合索引")]),s._v(" "),a("p",[s._v("索引只能放在硬盘中，所以磁盘的IO次数决定了查询性能")]),s._v(" "),a("h4",{attrs:{id:"二叉树"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二叉树"}},[s._v("#")]),s._v(" 二叉树")]),s._v(" "),a("p",[s._v("B树(Balance Tree)")]),s._v(" "),a("p",[s._v("高度小于二叉树")]),s._v(" "),a("p",[s._v("P表示指针")]),s._v(" "),a("p",[s._v("B+树")]),s._v(" "),a("h4",{attrs:{id:"应该加索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应该加索引"}},[s._v("#")]),s._v(" 应该加索引")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("经常被查询的列并且数据量比较大")])]),s._v(" "),a("li",[a("p",[s._v("自增主键默认索引")])])]),s._v(" "),a("h4",{attrs:{id:"不需要加索引的列"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不需要加索引的列"}},[s._v("#")]),s._v(" 不需要加索引的列")]),s._v(" "),a("p",[s._v("数据离散值低(数据重复率高，例如性别)")]),s._v(" "),a("h3",{attrs:{id:"测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),a("p",[s._v("添加索引前，大约0.5s")]),s._v(" "),a("p",[s._v("添加索引后，大约25ms，差了20倍")]),s._v(" "),a("p",[s._v("默认添加的索引是BTREE")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" product "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"998083趾饭"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" index_title "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"hash索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hash索引"}},[s._v("#")]),s._v(" HASH索引")]),s._v(" "),a("p",[s._v("Hash函数：  值 ==> 数")]),s._v(" "),a("p",[s._v("Hash索引： 值 ==> 桶 ==> 数据行")]),s._v(" "),a("p",[s._v("应用条件更为苛刻")]),s._v(" "),a("p",[s._v("最常用的索引也就是B-tree索引和Hash索引，且只有"),a("code",[s._v("Memory")]),s._v("，"),a("code",[s._v("NDB")]),s._v("两种引擎支持Hash索引。")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:%5CUsers%5CPanXin%5CAppData%5CRoaming%5Cmarktext%5Cimages%5C2022-11-21-10-29-16-image.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"联合索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#联合索引"}},[s._v("#")]),s._v(" 联合索引")]),s._v(" "),a("p",[s._v("两个列合起来是一个索引")]),s._v(" "),a("h4",{attrs:{id:"联合索引的最左原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#联合索引的最左原则"}},[s._v("#")]),s._v(" 联合索引的最左原则：")]),s._v(" "),a("p",[s._v("一定要按照顺序查询，最左侧列一定要出现")]),s._v(" "),a("h3",{attrs:{id:"索引失效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引失效"}},[s._v("#")]),s._v(" 索引失效")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("%%,双%like会使索引失效")])]),s._v(" "),a("li",[a("p",[s._v("右侧单%，索引正常")])]),s._v(" "),a("li",[a("p",[s._v("or的左右两侧有一个没有索引会失效")])]),s._v(" "),a("li",[a("p",[s._v("!= > <")])]),s._v(" "),a("li",[a("p",[s._v("索引提高了查询的效率，但也降低了增删改的效率")])]),s._v(" "),a("li",[a("p",[s._v("尽量使用数字类型字段")])])]),s._v(" "),a("h3",{attrs:{id:"执行计划"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行计划"}},[s._v("#")]),s._v(" 执行计划")]),s._v(" "),a("p",[s._v("语句前加"),a("code",[s._v("explain")]),s._v("可以查看执行时是否有索引等信息")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("rows 扫描行数，不准，一般值越小越好")])]),s._v(" "),a("li")]),s._v(" "),a("p",[s._v('EXPLAIN SELECT * from product WHERE title = "998105驼跺"')]),s._v(" "),a("p",[s._v("id    select_type    table    type    possible_keys    key    key_len    ref    rows    Extra\n1    SIMPLE    product    ref    index_title    index_title    767    const    1    Using where")]),s._v(" "),a("h3",{attrs:{id:"_5-性能分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-性能分析"}},[s._v("#")]),s._v(" 5. 性能分析")]),s._v(" "),a("p",[s._v('show global status like "com_______"')]),s._v(" "),a("h4",{attrs:{id:"慢查询日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#慢查询日志"}},[s._v("#")]),s._v(" 慢查询日志")]),s._v(" "),a("p",[s._v("SHOW GLOBAL VARIABLES LIKE '%log%';")]),s._v(" "),a("p",[s._v("开启方法")]),s._v(" "),a("h3",{attrs:{id:"_6-mysql查询优化方法-重点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-mysql查询优化方法-重点"}},[s._v("#")]),s._v(" 6. Mysql查询优化方法"),a("mark",[s._v(" 重点")])]),s._v(" "),a("p",[s._v("思路：便面全表扫描")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("禁止用* 来查询，需要指定字段")])]),s._v(" "),a("li",[a("p",[a("mark",[s._v("in的个数在1000个以内")])])]),s._v(" "),a("li",[a("p",[s._v("查询一条数据使用limit 1")])]),s._v(" "),a("li",[a("p",[s._v("尽量使用inner join 避免使用left join")])]),s._v(" "),a("li",[a("p",[s._v("!= 用 > or < 替换")])]),s._v(" "),a("li",[a("p",[s._v("between代替in")])]),s._v(" "),a("li",[a("p",[s._v("exist 代替in")])])]),s._v(" "),a("p",[s._v("例如：优化前10s，优化后5s")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("  product "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" product "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'24吻'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("or")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'25折'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" product p "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" product t "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'24吻'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("or")]),s._v(" p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'25折'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"8"}},[a("li",[a("p",[s._v("left josin 代替in")])]),s._v(" "),a("li",[a("p",[s._v("尽量不适用mysql自己的函数")])]),s._v(" "),a("li",[a("p",[s._v("使用union all 代替 union")])])]),s._v(" "),a("h2",{attrs:{id:"主从备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主从备份"}},[s._v("#")]),s._v(" 主从备份")]),s._v(" "),a("p",[s._v("双机热备就是使用MySQL提供的一种主从备份机制实现。所谓双机热备其实是一个复制的过程，复制过程中一个服务器充当主服务器，一个或多个服务器充当从服务。这个复制的过程实质上是从服务器复制主服务器上MySQL的二进制日志（bin-log），并在从服务器上还原主服务器上的操作。")]),s._v(" "),a("h3",{attrs:{id:"要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#要求"}},[s._v("#")]),s._v(" 要求")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("MySQL的版本高于3.2")])]),s._v(" "),a("li",[a("p",[s._v("从服务器的MySQL版本不可以低于主服务器的数据库版本")])])]),s._v(" "),a("h3",{attrs:{id:"操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作"}},[s._v("#")]),s._v(" 操作")]),s._v(" "),a("h4",{attrs:{id:"_1-主服务器授权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-主服务器授权"}},[s._v("#")]),s._v(" 1. 主服务器授权")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FILE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("REPLICATION")]),s._v(" SLAVE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("backup")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@192.168.11.40")]),s._v(" IDENTIFIED "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-同步数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-同步数据"}},[s._v("#")]),s._v(" 2. 同步数据")]),s._v(" "),a("h4",{attrs:{id:"_3-配置主服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置主服务器"}},[s._v("#")]),s._v(" 3. 配置主服务器")]),s._v(" "),a("p",[s._v("停止MySQL服务，修改主的my.ini，找到mysqId")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token section"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("mysqld")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("server-id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是1~2^23-1内的唯一值且不能与B或其它slave服务中的配置相同")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("log-bin")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("bin_log")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志文件以bin_log为前缀,如果不给log-bin赋值,日志文件将以#master-server-hostname为前缀")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog-ignore-db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志文件跳过的数据库(可选属性 ),如果有多个数据库，可以重复配置这个属性")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("binlog-do-db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("db_test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志文件操作的数据库(可选属性 ，默认所有数据库的相关操作都写入二进制日志文件) ,如果有多个数据库，可以重复配置这个属性")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("expire_logs_days")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("30")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("启动MySQL")]),s._v(" "),a("h4",{attrs:{id:"_4-修改从服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-修改从服务器"}},[s._v("#")]),s._v(" 4.  修改从服务器")]),s._v(" "),a("p",[s._v("修改/etc/my.cnf")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("server-id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#唯一并与主服务器上的server-id不同。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("replicate-do-db")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("db_test")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#复制操作要针对的数据库(可选，默认为全部)，同样如果有多个数据库则可配置多次本属性。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("expire_logs_days")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("30")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置bin-log日志保存的天数")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl restart mysqld.service "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启 mysql")]),s._v("\n用mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" 登录MySQL，并执行如下命令：\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("change master to "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("master_host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.11.184'")]),s._v(",\n-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("master_user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backup'")]),s._v(",\n-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("master_password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nsystemctl restart mysqld.service "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启 mysql")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ol",[a("li",[a("p",[s._v("start slave;")])]),s._v(" "),a("li",[a("p",[s._v("检查状态show slave status \\G；")])])]),s._v(" "),a("p",[s._v("必须两个都是yes，如果是connecting，关闭下防火墙试一下，进一步在主数据库插入一条数据后在从数据库检查下有没有数据")]),s._v(" "),a("p",[s._v("Slave_IO_Running: Yes\nSlave_SQL_Running: Yes")]),s._v(" "),a("div",{staticClass:"language-pure line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-pure"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("***************************")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("row")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("***************************")]),s._v("\n               Slave_IO_State"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Waiting for master to send event\n                  Master_Host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".11")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".184")]),s._v("\n                  Master_User"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" backup\n                  Master_Port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n                Connect_Retry"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n              Master_Log_File"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" bin_log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("000001")]),s._v("\n          Read_Master_Log_Pos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v("\n               Relay_Log_File"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("relay"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("000004")]),s._v("\n                Relay_Log_Pos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("302")]),s._v("\n        Relay_Master_Log_File"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" bin_log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("000001")]),s._v("\n             Slave_IO_Running"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Yes\n            Slave_SQL_Running"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Yes\n              Replicate_Do_DB"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" security\n          Replicate_Ignore_DB"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n           Replicate_Do_Table"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n       Replicate_Ignore_Table"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      Replicate_Wild_Do_Table"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  Replicate_Wild_Ignore_Table"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n                   Last_Errno"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n                   Last_Error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n                 Skip_Counter"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n          Exec_Master_Log_Pos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v("\n              Relay_Log_Space"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("513")]),s._v("\n              Until_Condition"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" None\n               Until_Log_File"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n                Until_Log_Pos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n           Master_SSL_Allowed"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" No\n           Master_SSL_CA_File"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n           Master_SSL_CA_Path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n              Master_SSL_Cert"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n            Master_SSL_Cipher"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n               Master_SSL_Key"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        Seconds_Behind_Master"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nMaster_SSL_Verify_Server_Cert"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" No\n                Last_IO_Errno"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n                Last_IO_Error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n               Last_SQL_Errno"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n               Last_SQL_Error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  Replicate_Ignore_Server_Ids"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n             Master_Server_Id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n                  Master_UUID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n             Master_Info_File"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("master"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v("info\n                    SQL_Delay"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n          SQL_Remaining_Delay"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("NULL")]),s._v("\n      Slave_SQL_Running_State"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Slave has read "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("all")]),s._v(" relay log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" waiting for more updates\n           Master_Retry_Count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("86400")]),s._v("\n                  Master_Bind"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      Last_IO_Error_Timestamp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n     Last_SQL_Error_Timestamp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n               Master_SSL_Crl"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n           Master_SSL_Crlpath"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n           Retrieved_Gtid_Set"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n            Executed_Gtid_Set"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n                Auto_Position"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n         Replicate_Rewrite_DB"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n                 Channel_Name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n           Master_TLS_Version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("row")]),s._v(" in set "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br")])]),a("h3",{attrs:{id:"失败的解决办法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#失败的解决办法"}},[s._v("#")]),s._v(" 失败的解决办法")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.staticaly.com/gh/pxpy/img@master/lQLPJxbk9Cy0gznNAw7NA0iwDiEo4xB9fiMDeC8mxoCbAA_840_782.6gxpbjllu2g0.webp",alt:"lQLPJxbk9Cy0gznNAw7NA0iwDiEo4xB9fiMDeC8mxoCbAA_840_782"}})]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/zzddada/article/details/113352717",target:"_blank",rel:"nofollow noopener noreferrer"}},[s._v("MySQL主从同步故障：Slave_SQL_Running:No 两种解决办法_Lucky@Dong的博客-CSDN博客"),a("OutboundLink")],1),a("a",{attrs:{href:"https://blog.csdn.net/zzddada/article/details/113352717",target:"_blank",rel:"nofollow noopener noreferrer"}},[s._v("MySQL主从同步故障：Slave_SQL_Running:No 两种解决办法_Lucky@Dong的博客-CSDN博客"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"spring-boot-读写分离"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot-读写分离"}},[s._v("#")]),s._v(" spring boot 读写分离")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://gitee.com/baomidou/dynamic-datasource-spring-boot-starter",target:"_blank",rel:"nofollow noopener noreferrer"}},[s._v("dynamic-datasource-spring-boot-starter: 基于 SpringBoot 多数据源 动态数据源 主从分离 快速启动器 支持分布式事务 (gitee.com)"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("如果数据库挂了一个，例如从服务器，会一直报错，项目也不能启动，需要注释不能使用的数据源")]),s._v(" "),a("h3",{attrs:{id:"mysql备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql备份"}},[s._v("#")]),s._v(" MySQL备份")])],1)}),[],!1,null,null,null);a.default=e.exports}}]);